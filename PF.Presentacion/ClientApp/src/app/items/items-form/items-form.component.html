<div class="card">
  <div class="card-header">
    <h3>{{EditionMode ? 'Editar' : 'Agregar'}} Item</h3>
  </div>

  <div class="card-body">
    <form class="form-horizontal" novalidate
          (ngSubmit)="save()" [formGroup]="formGroup">
      <fieldset>
        <div class="form-group">
          <label class="col-md-2 control-label">Nombre</label>
          <div class="col-md-12">
            <input class="form-control" id="name" type="text" required formControlName="name" />
          </div>
        </div>

        <div class="row">
          <div class="col-md-4">
            <label class="col-md-12 control-label">Materiales</label>
            <div class="col-md-12">
              <select class="form-control col-md-12" [ngModelOptions]="{standalone: true}" [(ngModel)]="materialId" (change)="onSelectMaterial($event.target.value)">
                <option value="0">--Material--</option>
                <option *ngFor="let material of materialsComboBox" value={{material.id}}>{{material.name}}</option>
              </select>
            </div>
          </div>

          <div class="col-md-4">
            <label class="col-md-12 control-label">Cantidad</label>
            <div class="col-md-12">
              <div class="form-group">
                <input class="form-control" id="quantity" [(ngModel)]="quantity" type="number" required formControlName="quantity" />
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <button class="btn btn-primary" id="button_center" [disabled]="!materialId" type="button" (click)="addMaterial()">Agregar</button>
          </div>
        </div>

        <br />

        <div *ngIf="materials.length">
          <label class="col-md-4 control-label">Materiales Seleccionados</label>
          <div class="col-md-12">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Id</th>
                  <th>Nombre</th>
                  <th>Cantidad</th>
                  <th>Precio</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let material of materials; let i = index">
                  <td>{{ material.material.id }}</td>
                  <td>{{ material.material.name }}</td>
                  <td>{{ material.quantity }}</td>
                  <td>{{ material.material.price }}</td>
                  <td>
                    <div class="btn-group">
                      <button class="btn btn-danger btn-space" type="button" (click)="removeMaterial(i)">Quitar</button>
                    </div>
                  </td>
                </tr>
                <tr *ngIf="price">
                  <td></td>
                  <td></td>
                  <th>Total</th>
                  <th>${{price}}</th>
                  <th></th>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="form-group">
          <div class="col-md-4 col-md-offset-2">
            <span>
              <button class="btn btn-primary  btn-space"
                      type="submit"
                      [disabled]="!formGroup.valid">
                Guardar
              </button>
              <button class="btn btn-secondary btn-space"
                      type="button"
                      [routerLink]='["/items"]'>
                Cancelar
              </button>
            </span>
          </div>
        </div>
      </fieldset>
    </form>

  </div>
</div>
